aliases:
  PathItem:
    - '$.paths[*]'
  OperationObject:
    - '#PathItem[get,put,post,delete,options,head,patch,trace]'
  ResponseObject:
    targets:
      - formats: [oas3]
        given: ['#OperationObject.responses[*]', '$.components.responses[*]']
  LinkObject:
    targets:
      - formats: [oas3]
        given: ['$.components.links[*]', '#ResponseObject.links[*]']
functions:
  - serverVariables
functionsDir: "../../functions"
rules:
  oas3-server-variables:
    description: Переменные из servers должны быть определены в variables и не должно быть неиспользуемые переменных
    documentationUrl: https://gitlabci.raiffeisen.ru/cib/api-guide/-/tree/master/spectral/rules?ref_type=heads#oas3-server-variables
    severity: error
    given: [ '$.servers[*]', '#PathItem.servers[*]', '#OperationObject.servers[*]', '#LinkObject.server' ]
    then:
      function: serverVariables
      functionOptions:
        checkSubstitutions: true
        requireDefault: true