# Описание Spectral инструмента и структуры правил

## Что такое Spectral?

[Spectral](https://docs.stoplight.io/docs/spectral) - это гибкий линтер для спецификаций OpenAPI/Swagger, который
позволяет определять пользовательские правила
валидации. Он помогает обеспечить согласованность, полноту и соответствие документации API стандартам вашей организации.

## Что такое rulesets?

Rulesets (наборы правил) - это конфигурации, которые определяют, какие проверки должны выполняться на спецификациях API.
В этом проекте есть два основных набора правил:

1. **Required Ruleset** - содержит обязательные правила валидации, которые должны быть соблюдены для публикации на портал
2. **Base Ruleset** - содержит дополнительные правила для расширенной валидации. Best Practices + API Guide

## Структура проекта

Проект организован следующим образом:

- `rules/` - содержит наборы правил
    - `required/` - обязательные правила
    - `base/` - расширенный набор правил
- `functions/` - пользовательские функции, используемые в правилах
- `tests/` - тесты для проверки правил

## Сборка rulesets

Наборы правил собираются с помощью скрипта, который объединяет отдельные файлы правил в полные rulesets:

```bash
./build-rulesets.sh
```
>Данный скрипт требует установленной утилиты yq.   

Этот скрипт генерирует:

- `required-ruleset.yaml` - объединенный обязательный ruleset
- `base-ruleset.yaml` - объединенный базовый ruleset

Данный файл не нужно запускать в ручную. Он будет автоматически запущен с помощью Husky Hooks при коммите изменений.

## Тестирование

Тесты запускаются с помощью Jest:

```bash
npm test
```

## Публикация

NPM пакет правил, содержащий два рулсета required-ruleset.yaml и base-ruleset.yaml, публикуется автоматически средствами Gitlab. 
Пайплайн для публикации создаётся после добавления тега в репозитории Gitlab. 
Версия пакета будет соответствовать тегу. 

## Версионирование

Проект следует принципам семантического версионирования. Подробнее [Процесс версионирования API Guide](../сontributing/VERSIONING.md).

## Contribute

Вы можете внести свой вклад в развитие автоматизированных правил, для этого ознакомьтесь с [CONTRIBUTING.md](../сontributing/CONTRIBUTING.md)