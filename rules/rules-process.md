
# Процесс изменения правил

- [Процесс изменения правил](#процесс-изменения-правил)
    - [Глоссарий](#глоссарий)
    - [Общее и частное](#общее-и-частное)
    - [Процесс изменения правил](#процесс-изменения-правил-1)
      - [Описание процесса изменения правил](#описание-процесса-изменения-правил)
      - [Обратная совместимость правил](#обратная-совместимость-правил)
      - [Как мы будем взаимодействовать с API](#как-мы-будем-взаимодействовать-с-api)
        - [Централизованный гейтвей(Integrations, RBO, Mobile)](#централизованный-гейтвейintegrations-rbo-mobile)
        - [Разные гейтвеи для продуктов](#разные-гейтвеи-для-продуктов)
      - [Где мы храним и публикуем правила?](#где-мы-храним-и-публикуем-правила)
      - [Обязательность правил](#обязательность-правил)


### Глоссарий

- **Принцип** - общее положение или утверждение, на основе которого формируются правила.
- **Правило** - требование на соблюдение каких-либо условий, имеющее определенную обязательность(Severity).
- **Severity** - Индикатор обязательности правила. Имеет 2 значения(MUST, RECOMMENDATION). MUST - соблюдаем обязательно. RECOMMENDATION - рекомендуется для соблюдения.
- **Гайд** - документ, который содержит принципы и правила.
- **Maintainer** - человек или команда отвечающие за процесс изменения гайда. 
- **Contributor** - инициатор изменений в гайд.


### Общее и частное
- Есть общая часть и мы стараемся все правила закладывать в общий гайд.
- Правила накладываются на все уровни API(внешние, внутренние, продуктовые)
- Специфика продукта не должна конфликтовать с общими правилами

### Процесс изменения правил
- Команды Raif Pay и Raif API являются одними из команд-мейнтейнеров процесса изменения правил
- Решения об изменении правил принимаются с апрувом каждого мейнтейнера процесса
- Финальное решение по принятию изменений в гайд согласуется между мейнтенарами

#### Описание процесса изменения правил

В процессе разработки или ревью API может возникнуть ситуация когда мы понимаем что гайд либо устарел, либо противоречит здравому смыслу, либо мы хотим что-то добавить в гайд.

- Описываем предлагаемые изменения, согласно формату правил приведенному в отдельном документе, с обоснованием предлагаемого изменения. Создаем MR и скидываем в чат сообщества [~cib_api_first](https://mattermost.raiffeisen.ru/raiffeisenbank/channels/cib_api_first)?
- Новости, дайджесты и use-cases в канал [~raif-api](https://mattermost.raiffeisen.ru/raiffeisenbank/channels/raif-api)
- Обязанность сообщества проводить review предлагаемых MR.
- Для решения некоторых вопросов могут быть организованы встречи. Решение по встрече формируется в процессе обсуждения MR. Мейнтейнеры сообщества приоритизируют и создают встречу по предлагаемому изменению.

#### Обратная совместимость правил
- Если вышла новая версия гайда с ломающими изменениями, то API разработанные ранее самостоятельно решают о необходимости доработок
- TBD - версионирование гайда

#### Как мы будем взаимодействовать с API

- TBD - хотим ли мы добавить в обсуждения гайда API First другие темы из релизного цикла API(публикация в каналы, инструменты, внедрение подходов)

##### Централизованный гейтвей(Integrations, RBO, Mobile)
- `api.raiffeisen.ru` - гейтвей для доступа к API продуктов

Пример API на гейтвее:
- `api.raiffeisen.ru/fx/v1/trades/1`

Если мы будем публиковать внутренние API в канале Raif API, они будут доступны каким-то способом(ниже примеры)
- `api.raiffeisen.ru/internal/fx/v1/trades/1`
- `internal.api.raiffeisen.ru/fx/v1/trades/1`
- `api.raiffeisen.ru/fx/beta/trades/1`

##### Разные гейтвеи для продуктов
- Обсуждаем конкретные кейсы с командами
  
---

#### Где мы храним и публикуем правила?
- Gitlab - храним правила в репозитории https://gitlabci.raiffeisen.ru/cib/api-guide
- Формируем артефакты(принципы, правила) заново
- Raif API ссылается(визуализирует) правила в Gramax(портал документации)

#### Обязательность правил
Обязательность(Severity) для правил пока выделяем 2-ух типов:
- MUST - соблюдаем обязательно
- RECOMMENDATION - рекомендуется для соблюдения
